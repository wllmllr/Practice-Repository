(function(g){var n=0,f=function(s,u,p){var r=0,v=u.length,q="",o="",t=p||s;for(r=0;r<v;r=r+1){q=u[r];o=q.replace(/^data\-/,"");if(s.attr(q)){t.data(o,s.attr(q));s.removeAttr(q)}}},h=function(s,q,o){var p=0,t=q.find(s),r=o||q;t.each(function(){var u=g(this);r.data(u.attr("class").replace(/^qz\-/,""),u.html());u.remove()})},c=function(o){var p=o.eq(0).parent("ul, ol, div.quiz-items");o.sort(function(r,q){var s=parseInt(Math.random()*10,10),t=s%2,u=s>5?1:-1;return(t*u)}).appendTo(p)},d=function(v,p,q){var u=p.split(","),s=0,t=u.length,r=function(w){return w.toLowerCase().replace(/[^A-z]/ig,"")},o=false;for(s=0;s<t;s=s+1){if((r(u[s])===r(v))&&!q||(u[s]===v)){o=true;break}}return o},k=function(o){return o.data("num")},m=function(o){var p=o.parents("div.quiz-items > div").eq(0);return p},i=function(o){var q=parseInt(o.css("top").replace("px",""),10),p=parseInt(o.css("left").replace("px",""),10);return{top:isNaN(q)?0:q,left:isNaN(p)?0:p,width:o.width(),height:o.height()}},a=function(p,o,s){var r=p.data("orig-position");if(!r){var q=i(p);p.data("orig-position",q);r=q}p.css({top:Math.floor(r.top*s)+"px",left:Math.floor(r.left*o)+"px",width:Math.floor(r.width*o)+"px",height:Math.floor(r.height*s)+"px"})},b=[],l=0,j={multi:{init:function(o){var q=b[o],p=q.el,r=p.find("ul.quiz-body li"),s=r.find('input[type="radio"], input[type="checkbox"]');correctOptions=s.filter('[data-correct="true"]');possibleCorrect=correctOptions.length,multiCorrect=0,submitButton=p.find(".qz-item-submit");c(s);r=p.find("ul.quiz-body li");r.each(function(){var v=g(this),t=v.html(),u;u=v.find("input");f(u,["data-correct"]);h(".qz-feedback",v,u);if(u.data("correct")){multiCorrect=multiCorrect+1}});q.correctels=correctOptions;q.mainels=s;q.data.numcorrect=possibleCorrect;q.data.multicorrect=multiCorrect;q.triggerel=submitButton;submitButton.on("click.multi","",{self:this,qix:o},this.check)},check:function(s){var w=s.data.qix,u=b[w],v=u.el,p=v.find("input:checked"),x=u.data.multicorrect,q=p.length,t=false,o="",r=0;if(q>0){if(q===1&&x===q){t=p.data("correct"),o=p.data("feedback")}else{p.each(function(){var y=g(this);if(y.data("correct")){r=r+1}o=o+y.data("feedback")+"<br>"});if(r===q&&q===x){t=true}o=r+"/"+x+" correct options checked<br>"+o}e.showFeedback(u.feedbackel,o,t);e.update(w,t)}},disable:function(o){var p=b[o];p.triggerel.off(".multi");p.triggerel.attr("disabled","disabled");p.mainels.each(function(){var q=g(this);if(q.data("correct")){q.parent().append('<span class="label label-success"><i class="icon-ok icon-white"></i> Correct</span>')}});p.mainels.attr("disabled","disabled");e.endquiz()},helper:function(o){}},fillin:{init:function(o){var q=b[o],p=q.el,r=p.find("input");r.each(function(){var s=g(this);f(s,["data-correct"]);h(".qz-feedback-right, .qz-feedback-wrong",p,s)});q.mainels=r;r.on("change.fillin","",{self:this,qix:o},this.check)},check:function(u){var p=u.data.qix,s=b[p],r=s.el,t=g(this),q=t.data("strict"),o=d(t.val(),t.data("correct"),q),v=o?t.data("feedback-right"):t.data("feedback-wrong");e.showFeedback(s.feedbackel,v,o);e.update(p,o)},disable:function(o){var p=b[o];p.mainels.off(".fillin");p.mainels.attr("disabled","disabled");e.endquiz()},helper:function(o){}},hotspot:{init:function(w){var t=b[w],v=t.el,p=v.find(".qz-item-submit"),o=v.find(".quiz-hot-spot"),r=v.find(".quiz-hot-drop"),q=v.find(".quiz-hotspot-backdrop"),x=parseInt(q.data("image-width"),10),u=parseInt(q.data("image-height"),10),s=function(){var z=q.width(),y=q.height(),B=y/u,A=z/x;a(o,A,B);a(r,A,B)};hit=false;s();g(window).smartresize(function(){s()});t.triggerel=p;t.mainels=o;t.correctels=r;o.draggable({containment:"parent"});r.droppable({containment:"parent"});r.on("dropover",function(z,y){r.data("hit",true)});r.on("dropout",function(z,y){r.data("hit",false)});h(".qz-feedback-right, .qz-feedback-wrong",v);p.on("click.hotspot","",{self:this,qix:w},this.check)},check:function(t,s){var o=t.data.qix,r=b[o],p=r.el,q=r.correctels.data("hit")||false,u=q?p.data("feedback-right"):p.data("feedback-wrong");e.showFeedback(r.feedbackel,u,q);e.update(o,q)},disable:function(o){var p=b[o];p.triggerel.off(".hotspot");p.triggerel.attr("disabled","disabled");p.mainels.draggable("disable");p.correctels.addClass("quiz-hot-drop-set");e.endquiz()},helper:function(s){var o=s,r=o.find(".qz-item-submit"),p=o.find(".quiz-hot-drop"),q=p.parent();showPositionString=function(){var u=p.position(),t=q.position();var v=prompt("Copy this string",'style="position: relative; width: '+p.width()+"px; height: "+p.height()+"px; top: "+Math.floor(u.top-t.top)+"px; left: "+Math.floor(u.left-t.left)+'px;"')};p.css({height:"30px"});p.addClass("quiz-hot-drop-set");p.draggable({containment:"parent"});p.resizable();p.on("resizestart",function(){p.draggable("option","disabled",true)});p.on("resizestop",function(){p.draggable("option","disabled",false)});r.on("click",function(){showPositionString()})}}},e={stats:function(){var r=0,p=0,s=0,o=0,q=100;for(r=0;r<l;r=r+1){p=p+(b[r].correct?1:0);if(b[r].status===1){s=s+1
}}o=Math.round((p/l)*100);return{correct:p,completed:s,total:l,percentRight:o,percentTotal:q}},endquiz:function(){var o=this.stats(),q=g(".quiz-stats"),p=o.percentRight+"%";if(o.completed===l&&q.length>0){q.slideDown();g(".progress .bar").css("width",p);g("#quiz-percent").html(p);g("#quiz-possible").html(o.total);g("#quiz-score").html(o.correct)}},update:function(p,o){var q=b[p];qiStatus=function(r){if(r>=0){q.status=r}return q.status},qiAttempts=function(r){qiAttemptVal=q.attempts;if(r){q.attempts=qiAttemptVal+r}return q.attempts},qiIsCorrect=function(r){if(r){q.correct=r}return q.correct},hitLimit=function(){var r=q.attempts===q.tries||q.correct?true:false;return r};if(o){qiIsCorrect(true)}qiAttempts(1);if(hitLimit()||o){qiStatus(1);j[q.quiztype].disable(p)}else{qiStatus(0)}},showFeedback:function(q,r,p){var o=q.hasClass("alert-info");q.html(r);if(p){q.switchClass(o?"alert-info":"alert-error","alert-success")}else{q.switchClass(o?"alert-info":"alert-success","alert-error")}}};g.fn.dlquiz=function(){var q=g(this),r=g(".quiz-items > div"),p=q.data("writer-mode"),o=q.data("random");if(!p){if(o){c(r)}r=g(".quiz-items > div");quizItemLength=r.length;r.each(function(s){var t=g(this);quizStatement=t.find(".quiz-item-statement");b.push({el:t,ix:s,quiztype:t.data("quiz-type"),attempts:0,tries:t.data("quiz-tries"),status:-1,correct:false,feedbackel:t.find(".qz-feedback-area"),data:{}});l=l+1;t.data("ix",s);quizStatement.html((s+1)+". "+quizStatement.html());if(j[b[s].quiztype]){j[b[s].quiztype].init(s)}})}else{r.each(function(t){var s=g(this);if(j[s.data("quiz-type")]){j[s.data("quiz-type")].helper(s)}})}q.css("visibility","visible");return{stats:e.stats,qi:b}};g.fn.dlquiz.version="0.2"})(jQuery);var qz=$(".quiz-area").dlquiz();